<!-- ðŸ“‹ Review Form -->
<div id="review_form">
  <%= form_with(model: [@product, review], local: false) do |f| %>
    <div class="mb-2">
      <%= f.label :rating, "Rating", class: "form-label small fw-semibold" %>
      <%= f.select :rating, options_for_select(1..5, review.rating), {}, class: "form-select" %>
    </div>

    <div class="mb-2">
      <%= f.label :comment, "Comment", class: "form-label small fw-semibold" %>
      <%= f.text_area :comment, rows: 3, class: "form-control" %>
    </div>

    <%= f.submit "Submit Review", class: "btn btn-primary fw-semibold" %>
  <% end %>
</div>

<!-- â­ Single Review Card -->
<div class="border rounded-3 p-3 mb-3 bg-light" id="<%= dom_id(review) %>">
  <strong><%= review.user.name %></strong>
  <%= render_stars(review.rating) %> â€” <%= review.comment %>
  <div class="text-muted small"><%= review.created_at.strftime("%b %d, %Y") %></div>

  <!-- ðŸ‘ Helpful Voting -->
  <div class="mt-2">
    <span id="<%= dom_id(review, :helpful_count) %>" class="small text-muted">
      <%= review.helpful_count %> people found this helpful
    </span>
    <%= button_to "Helpful",
          vote_product_review_path(@product, review),
          method: :post,
          class: "btn btn-sm btn-outline-success ms-2",
          data: { turbo_stream: true } %>
  </div>

  <!-- âœï¸ Edit/Delete for Owner -->
  <% if review.user == current_user %>
    <div class="mt-2">
      <%= link_to "Edit",
            edit_product_review_path(@product, review),
            class: "btn btn-sm btn-outline-secondary" %>

      <%= button_to "Delete",
            product_review_path(@product, review),
            method: :delete,
            class: "btn btn-sm btn-danger" %>
    </div>
  <% end %>
</div>
