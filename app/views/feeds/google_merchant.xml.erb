<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:g="http://base.google.com/ns/1.0">
  <channel>
    <title>Tajaone - Leather Products Kenya</title>
    <link>https://tajaone.app</link>
    <description>High-quality, affordable leather bags, shoes &amp; accessories in Kenya</description>
    <language>en-us</language>
    <lastBuildDate><%= Time.current.to_fs(:rfc822) %></lastBuildDate>

    <% @products.each do |product| %>
      <item>
        <!-- Required Fields -->
        <g:id><%= product.id %></g:id>
        <title><%= CGI.escapeHTML(product.title.to_s) %></title>
        <description><%= CGI.escapeHTML(truncate(product.description.to_s, length: 5000)) %></description>
        <g:price><%= product.price.to_i %> <%= product.currency || 'KES' %></g:price>
        <link><%= product_url(product, protocol: "https") %></link>
        <g:image_link><%= product.image_url.to_s %></g:image_link>
        <g:availability><%= product.stock.to_i > 0 ? 'in stock' : 'out of stock' %></g:availability>
        
        <!-- Recommended Fields -->
        <g:condition>new</g:condition>
        <g:brand>Tajaone</g:brand>
        <g:product_type><%= CGI.escapeHTML((product.category&.name || 'Leather Goods').to_s) %></g:product_type>
        <g:google_product_category>Apparel &amp; Accessories &gt; Bags &amp; Cases</g:google_product_category>
        
        <!-- Color (required for apparel) -->
        <% if product.try(:color).present? %>
          <g:color><%= CGI.escapeHTML(product.color.to_s) %></g:color>
        <% else %>
          <g:color>Brown</g:color>
        <% end %>
        
        <!-- Age Group -->
        <% if product.try(:age_group).present? %>
          <g:age_group><%= CGI.escapeHTML(product.age_group.to_s) %></g:age_group>
        <% else %>
          <g:age_group>adult</g:age_group>
        <% end %>
        
        <!-- Gender -->
        <% if product.try(:gender).present? %>
          <g:gender><%= CGI.escapeHTML(product.gender.to_s) %></g:gender>
        <% else %>
          <g:gender>unisex</g:gender>
        <% end %>
        
        <!-- Size (if applicable) -->
        <% if product.try(:size).present? %>
          <g:size><%= CGI.escapeHTML(product.size.to_s) %></g:size>
        <% end %>
        
        <!-- Additional Images -->
        <% if product.gallery_image_urls&.any? %>
          <% product.gallery_image_urls.first(10).each do |url| %>
            <g:additional_image_link><%= url %></g:additional_image_link>
          <% end %>
        <% end %>
        
        <!-- Shipping (Required) -->
        <g:shipping>
          <g:country>KE</g:country>
          <% if product.shipping_cost.to_f > 0 %>
            <g:price><%= product.shipping_cost.to_i %> <%= product.currency || 'KES' %></g:price>
          <% else %>
            <g:price>0 <%= product.currency || 'KES' %></g:price>
          <% end %>
          <% if product.estimated_delivery_range.present? %>
            <g:transit_time_label><%= CGI.escapeHTML(product.estimated_delivery_range) %></g:transit_time_label>
          <% else %>
            <g:transit_time_label>2-5 business days</g:transit_time_label>
          <% end %>
        </g:shipping>
        
        <!-- Weight -->
        <% if product.weight.present? && product.weight > 0 %>
          <g:shipping_weight><%= product.weight %> kg</g:shipping_weight>
        <% end %>
        
        <!-- Sale Price (if discount exists) -->
        <% if product.discount&.percentage.to_i > 0 %>
          <g:sale_price><%= (product.price * (1 - product.discount.percentage / 100.0)).round(2) %> <%= product.currency || 'KES' %></g:sale_price>
        <% end %>
        
        <g:mpn><%= product.id %></g:mpn>
      </item>
    <% end %>
  </channel>
</rss>
