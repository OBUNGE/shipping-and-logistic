<h1 class="fw-bold mb-4">
  <%= @category.name %> â€” Cheap Leather Products in Nairobi
</h1>

<div class="row">
  <% @products.each do |product| %>
    <div class="col-6 col-md-4 mb-4">
      <div class="card h-100 border-0 shadow-sm rounded-3 hover-zoom">

        <!-- ðŸ–¼ï¸ Product Image -->
        <% if product.image.attached? %>
          <%= link_to product_path(product) do %>
            <%= image_tag product.image.variant(resize_to_limit: [400, 300]),
                          alt: "#{product.title} | Cheap Leather Product Nairobi",
                          class: "card-img-top rounded-top object-fit-cover" %>
          <% end %>
        <% else %>
          <%= link_to product_path(product) do %>
            <%= image_tag asset_path("placeholder.jpg"),
                          alt: "Leather product placeholder",
                          class: "card-img-top rounded-top object-fit-cover" %>
          <% end %>
        <% end %>

        <!-- ðŸ“¦ Product Details -->
        <div class="card-body d-flex flex-column">
          <h5 class="fw-semibold text-truncate mb-2">
            <%= link_to product.title, product_path(product),
                        class: "text-dark text-decoration-none hover-link" %>
          </h5>

          <p class="text-primary fw-bold mb-1">
            KSh <%= number_to_currency(product.price, unit: "", precision: 0) %>
          </p>

          <p class="small mb-2 <%= product.stock.to_i > 0 ? 'text-success' : 'text-danger' %>">
            <%= product.stock.to_i > 0 ? "âœ… In Stock" : "âŒ Out of Stock" %>
          </p>

          <small class="text-muted">
            Sold by <%= link_to product.seller.store_name, seller_path(product.seller.store_slug),
                                class: "fw-semibold text-decoration-none hover-link" %>
          </small>

          <!-- ðŸ›’ Add to Cart -->
          <div class="mt-auto d-flex gap-2 pt-3">
            <% if product.stock.to_i > 0 %>
              <%= button_to "Add to Cart", add_cart_path,
                  method: :post,
                  params: { product_id: product.id },
                  remote: true,
                  form: { data: { turbo_stream: true } },
                  class: "btn btn-sm btn-primary flex-fill shadow-sm" %>
            <% else %>
              <button class="btn btn-sm btn-secondary flex-fill" disabled>Out of Stock</button>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>
