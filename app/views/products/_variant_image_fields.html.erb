<div id="<%= dom_id(f.object) %>" class="border p-2 mb-2 bg-light rounded variant-image-block">
  <%= f.hidden_field :id %>

  <% if f.object.image_url.present? && !f.object.image_url.start_with?("blob:") %>
    <%= image_tag f.object.image_url,
          class: "img-thumbnail mb-2 variant-image-preview",
          style: "max-height: 150px;" %>
  <% else %>
    <img class="img-thumbnail mb-2 variant-image-preview" 
         style="display:none; max-height: 150px;" />
  <% end %>

  <%= f.file_field :image,
        class: "form-control form-control-sm",
        accept: "image/*",
        onchange: "previewVariantImage(event)" %>

  <%= f.hidden_field :image_url,
        value: f.object.image_url,
        class: "image-url-field" %>
  
  <%= f.hidden_field :_destroy, class: "destroy-flag" %>

  <%# ðŸš¨ FIX 1: Use client-side button for ALL deletes %>
  <button type="button" class="btn btn-sm btn-outline-danger delete-variant-image">
    Delete
  </button>
</div>