<div id="<%= dom_id(f.object) %>"
Â  Â  Â class="border p-3 mb-2 bg-light rounded variant-block"
Â  Â  Â data-saved-value="<%= f.object.value %>"
Â  Â  Â data-key="<%= (f.object.id || Time.now.to_i) %>">

Â  Â  <%= f.hidden_field :id %>

Â  <div class="row g-2">
Â  Â  <div class="col-md-4">
      <%= f.label :name, "Type", class: "form-label small" %>
      <%= f.select :name,
          ["Color","Size","Storage","Material","Packaging"],
          { selected: f.object.name },
          class: "form-select form-select-sm variant-type",
          required: true %>
    </div>
    <div class="col-md-4">
      <%= f.label :value, "Option", class: "form-label small" %>
      <%= f.select :value,
          case f.object.name
          when "Color" Â  Â  then ["Black","Blue","Red","Green","White"]
          when "Size" Â  Â  Â then ["XS","S","M","L","XL","XXL"]
          when "Storage" Â  then ["64GB","128GB","256GB","512GB","1TB"]
          when "Material" Â then ["Cotton","Leather","Polyester","Plastic","Metal","Wood"]
          when "Packaging" then ["Box","Bag","Sachet","Envelope","Bottle","Jar"]
          else []
          end,
          { selected: f.object.value },
          class: "form-select form-select-sm variant-value",
          required: true,
          data: { current: f.object.value } %>
    </div>
    <div class="col-md-3">
      <%= f.label :price_modifier, "Price Modifier", class: "form-label small" %>
      <%= f.number_field :price_modifier,
          step: 0.01,
          placeholder: "e.g. 50.00",
          class: "form-control form-control-sm" %>
    </div>


Â  Â  Â  Â  <div class="col-md-1 d-flex align-items-end">
Â  Â  Â  <%= f.hidden_field :_destroy, class: "destroy-flag" %>

Â  Â  Â  <%# ðŸš¨ FIX: Always use the client-side button with the 'delete-variant' class. 
Â  Â  Â  Â  Â  Â  The JS handles setting the :_destroy flag for persisted records. %>
Â  Â  Â  <button type="button" class="btn btn-sm btn-outline-danger delete-variant">Delete</button>

Â  Â  </div>
Â  </div>

Â  Â  <div class="mt-2 color-image-actions <%= 'd-none' unless f.object.name == 'Color' %>">
Â  Â  <div class="variant-images-wrapper">
Â  Â  Â  <%= f.fields_for :variant_images do |image_fields| %>
Â  Â  Â  Â  <%= image_fields.hidden_field :id %>
Â  Â  Â  Â  <%= render "variant_image_fields", f: image_fields %>
Â  Â  Â  <% end %>
Â  Â  </div>

Â  Â  <%# ðŸš¨ FIX: The "Add color image" button for client-side must have the add-variant-image-btn class %>
Â  Â  <% if @product.persisted? && f.object.persisted? %>
Â  Â  Â  <%= button_to "âž• Add color image",
Â  Â  Â  Â  Â  Â  add_variant_image_product_path(@product, id: f.object.id),
Â  Â  Â  Â  Â  Â  method: :post,
Â  Â  Â  Â  Â  Â  data: { turbo_stream: true },
Â  Â  Â  Â  Â  Â  class: "btn btn-sm btn-outline-secondary" %>
Â  Â  <% else %>
Â  Â  Â  <button type="button"
Â  Â  Â  Â  Â  Â  Â  class="btn btn-sm btn-outline-secondary **add-variant-image-btn**">
Â  Â  Â  Â  âž• Add color image
Â  Â  Â  </button>
Â  Â  <% end %>
Â  </div>
</div>