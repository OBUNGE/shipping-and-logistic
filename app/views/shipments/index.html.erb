<h2>All Shipments</h2>

<%= form_with url: shipments_path, method: :get, local: true, class: "mb-4" do %>
  <div class="row g-3">
    <div class="col-md-3">
      <%= label_tag :status, "Status" %>
      <%= select_tag :status, options_for_select(["", "pending", "in_transit", "delivered"], params[:status]), class: "form-select" %>
    </div>

    <div class="col-md-3">
      <%= label_tag :query, "Order ID or Tracking #" %>
      <%= text_field_tag :query, params[:query], class: "form-control" %>
    </div>

    <div class="col-md-3">
      <%= label_tag :from, "From Date" %>
      <%= date_field_tag :from, params[:from], class: "form-control" %>
    </div>

    <div class="col-md-3">
      <%= label_tag :to, "To Date" %>
      <%= date_field_tag :to, params[:to], class: "form-control" %>
    </div>
  </div>

  <div class="mt-3">
    <%= submit_tag "Filter", class: "btn btn-primary" %>
    <%= link_to "Reset", shipments_path, class: "btn btn-outline-secondary ms-2" %>
  </div>
<% end %>

<table class="table mt-4">
  <thead>
    <tr>
      <th>Order</th>
      <th>Carrier</th>
      <th>Tracking</th>
      <th>Cost</th>
      <th>Status</th>
      <th>Updated</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @shipments.each do |shipment| %>
      <tr>
        <td><%= shipment.order_id %></td>
        <td><%= shipment.carrier %></td>
        <td><%= shipment.tracking_number %></td>
        <td>KES <%= number_to_currency(shipment.cost || 0, unit: "", precision: 2) %></td>
        <td><%= shipment.status.humanize %></td>
        <td><%= shipment.updated_at.strftime("%b %d, %Y %H:%M") %></td>
        <td><%= link_to "View", order_shipment_path(shipment.order), class: "btn btn-sm btn-outline-primary" %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<% if @shipments.empty? %>
  <p class="mt-4">No shipments found for the selected filters.</p>
<% end %>
